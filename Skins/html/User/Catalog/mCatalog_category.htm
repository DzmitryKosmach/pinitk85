<?php echo CssCopmress::load('catalog')?>
<?php echo JsCopmress::load('catalog')?>
<?php echo JsCopmress::load('compare')?>

<?php echo CssCopmress::load('category')?>
<?php echo JsCopmress::load('category')?>

<script>
  oCompare.url = '<?php echo Url::a('catalog-compare'); ?>';
</script>

<div>
  <div>
    <!-- Хлебные крошки -->
    <nav class="text-sm text-gray-500 flex flex-wrap items-center gap-1 mb-6 md:mb-10">
      <?php if(count($breadcrumbs)) { ?>
      <?php $bcLast = array_pop($breadcrumbs); ?>
      <?php $position = 0; ?>
      <?php foreach($breadcrumbs as $bc) { ?>
      <?php $position = $position + 1; ?>
      <a href="<?php echo $bc['url']; ?>" class="hover:text-gray-700">
        <?php echo $bc['name']; ?>
      </a>
      <span class="mx-1">›</span>
      <?php } ?>
      <span class="text-gray-700">
        <?php echo $bcLast['name']; ?>
      </span>
      <?php } ?>
    </nav>

    <section class="">
      <div>
        <h1 class="text-2xl font-bold mb-4 md:mb-8">
          <?php echo $pageInf['header']; ?>
        </h1>

        <!-- Табы -->
        <div
          class="sticky top-[56px] sm3:top-[32px] lg:top-[75px] pt-2 z-20 bg-body"
        >
          <div class="text-[11px] sm3:text-sm lg:text-base mb-6 lg:mb-12">
            <?php
              $visibleCount = 3;
              $visiblePages = array_slice($pages, 0, $visibleCount);
              $hiddenPages = array_slice($pages, $visibleCount);
            ?>

            <!-- Основной ряд: видимые табы + кнопка "Ещё" -->
            <div class="flex flex-wrap items-center gap-1 sm:gap-2">
              <!-- Видимые табы -->
              <?php foreach ($visiblePages as $p): ?>
              <?php $isActive = ($_SERVER['REQUEST_URI'] === Catalog_Pages::a($p['id'])); ?>
              <?php if ($isActive): ?>
              <span
                class="flex-1 min-h-8 px-1 md:px-4 lg:min-h-12 lg:px-8 leading-3 font-medium rounded-xl bg-blue-600 text-white border border-blue-600 shadow text-center flex items-center justify-center"
              >
                <?php echo htmlspecialchars($p['name']); ?>
              </span>
              <?php else: ?>
              <a
                href="<?php echo Catalog_Pages::a($p['id']); ?>"
                class="flex-1 min-h-8 px-4 lg:min-h-12 lg:px-8 leading-3 rounded-xl bg-white border border-gray-300 shadow text-center flex items-center justify-center text-gray-800 hover:bg-gray-50 transition"
              >
                <?php echo htmlspecialchars($p['name']); ?>
              </a>
              <?php endif; ?>
              <?php endforeach; ?>

              <!-- Кнопка "Ещё" — только если есть скрытые табы -->
              <?php if (!empty($hiddenPages)): ?>
              <button
                id="showMoreBtn"
                class="flex align-middle attention min-h-8 px-1 text-[11px] sm3:text-sm md:px-4 lg:min-h-12 lg:px-6 rounded-xl bg-blue-600 text-white shadow hover:bg-blue-700 flex items-center justify-center gap-1 transition whitespace-nowrap"
              >
                <span id="btnText">Ещё</span>
                <svg
                  id="btnIcon"
                  class="w-4 h-4 transition-transform duration-300"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19 9l-7 7-7-7"
                  />
                </svg>
              </button>
              <?php endif; ?>
            </div>

            <!-- Скрытые табы (изначально скрыты) -->
            <?php if (!empty($hiddenPages)): ?>
            <div
              id="hiddenWrapper"
              class="overflow-hidden max-h-0 opacity-0 transition-all duration-500 ease-in-out mt-2"
            >
              <div class="flex flex-wrap gap-1 sm:gap-2 pb-2">
                <?php foreach ($hiddenPages as $p): ?>
                <?php $isActive = ($_SERVER['REQUEST_URI'] === Catalog_Pages::a($p['id'])); ?>
                <?php if ($isActive): ?>
                <span
                  class="flex-1 min-h-8 px-1 md:px-4 lg:min-h-12 lg:px-8 leading-3 font-medium rounded-xl bg-blue-600 text-white border border-blue-600 shadow text-center flex items-center justify-center"
                >
                  <?php echo htmlspecialchars($p['name']); ?>
                </span>
                <?php else: ?>
                <a
                  href="<?php echo Catalog_Pages::a($p['id']); ?>"
                  class="flex-1 min-h-8 px-1 md:px-4 lg:min-h-12 lg:px-8 leading-3 rounded-xl bg-white border border-gray-300 shadow text-center flex items-center justify-center text-gray-800 hover:bg-gray-50 transition"
                >
                  <?php echo htmlspecialchars($p['name']); ?>
                </a>
                <?php endif; ?>
                <?php endforeach; ?>
              </div>
            </div>
            <?php endif; ?>
          </div>
        </div>

        <style>
          /* Анимация "пульс" для кнопки */
          @keyframes pulseAttention {
            0%,
            100% {
              transform: scale(1);
            }
            50% {
              transform: scale(1.08);
            }
          }
          .attention {
            animation: pulseAttention 1.5s infinite;
          }
        </style>

        <script>
          document.addEventListener("DOMContentLoaded", () => {
            const btn = document.getElementById("showMoreBtn");
            const btnText = document.getElementById("btnText");
            const btnIcon = document.getElementById("btnIcon");
            const hiddenWrapper = document.getElementById("hiddenWrapper");

            if (!btn || !hiddenWrapper) return;

            // Восстановление состояния из localStorage
            const isExpanded = localStorage.getItem("tabsExpanded") === "true";
            if (isExpanded) {
              hiddenWrapper.classList.remove("max-h-0", "opacity-0");
              hiddenWrapper.classList.add("max-h-[1000px]", "opacity-100");
              btnText.textContent = "Свернуть";
              btn.classList.remove(
                "bg-blue-600",
                "hover:bg-blue-700",
                "attention"
              );
              btn.classList.add("bg-gray-600", "hover:bg-gray-700");
              btnIcon.classList.add("rotate-180");
            }

            btn.addEventListener("click", () => {
              const isCollapsed = hiddenWrapper.classList.contains("max-h-0");

              if (isCollapsed) {
                // раскрыть
                hiddenWrapper.classList.remove("max-h-0", "opacity-0");
                hiddenWrapper.classList.add("max-h-[1000px]", "opacity-100");
                btnText.textContent = "Скрыть";
                btn.classList.remove(
                  "bg-blue-600",
                  "hover:bg-blue-700",
                  "attention"
                );
                btn.classList.add("bg-gray-600", "hover:bg-gray-700");
                btnIcon.classList.add("rotate-180");
                localStorage.setItem("tabsExpanded", "true");
              } else {
                // свернуть
                hiddenWrapper.classList.add("max-h-0", "opacity-0");
                hiddenWrapper.classList.remove("max-h-[1000px]", "opacity-100");
                btnText.textContent = "Ещё";
                btn.classList.remove("bg-gray-600", "hover:bg-gray-700");
                btn.classList.add(
                  "bg-blue-600",
                  "hover:bg-blue-700",
                  "attention"
                );
                btnIcon.classList.remove("rotate-180");
                localStorage.setItem("tabsExpanded", "false");
              }
            });
          });
        </script>

        <div class="grid grid-cols-2 sm2:grid-cols-4 gap-2 lg:gap-6">
          <?php if($pageWithSeries) { ?>
          <?php if(count($series)) { ?>
          <?php foreach($series as $sn =>
          $s) { ?>
          <?php include(_ROOT . Catalog_Series::$tpl)?>
          <?php } ?>
          <?php } else { ?>
          <?php echo Pages::msgErr('По вашему запросу серии мебели не найдены.')?>
          <?php } ?>
          <?php } else { ?>
          <?php if(count($items)) { ?>
          <?php echo CssCopmress::load('series')?>
          <?php echo JsCopmress::load('series')?>

          <script>
            oMaterials.tree = AJAX.jsonDecode('<?php echo str_replace('\'', '\\\'', toJson($materials)) ?> ');
          </script>
          <?php foreach($items as $in =>
          $i) { ?>
          <?php
                                    $seriesInf = array(
                                        'id'            =>
          $i['series_id'], 'category_id' => $i['category_id'], 'url' =>
          $i['s_url'] ); ?>
          <?php include(Config::path('skins') . '/html/Components/items_card.htm'); ?>
          <?php } ?>

          <?php } else { ?>
          <?php echo Pages::msgErr('По вашему запросу товары не найдены.')?>
          <?php } ?>
          <?php } ?>
        </div>

        <div class="flex w-full justify-center items-center flex-col mt-8">
          <?php echo $toggle; ?>
        </div>
      </div>
    </section>

    <section>
      <!-- Наши преимущества -->
      <h2 class="text-xl xl:text-2xl font-bold mt-32 mb-12">
        Наши преимущества
      </h2>

      <div
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 justify-between text-sm md:text-base font-medium"
      >
        <div class="flex items-start gap-2 bg-white p-3 shadow rounded">
          <div
            class="shadow-[inset_0px_0px_10px_4px_rgba(43,72,241,0.20)] p-3 rounded-md shrink-0"
          >
            <img
              src="/images/category/sofa.png"
              class="w-3 h-4 lg:w-5 lg:h-6 md:w-4 md:h-5"
              alt=""
            />
          </div>
          <p class="text-base xl:text-lg font-medium">
            Эксклюзивный дизайн:
            <span class="block text-sm xl:text-lg font-normal"
            >Наши дизайнерские коллекции мебели для кабинета руководителя
              эконом класса представлены в стильном сером, лофт и других
              современных оттенках. Создайте стильное рабочее
              пространство.</span
            >
          </p>
        </div>
        <div class="flex items-start gap-2 bg-white p-3 shadow rounded">
          <div
            class="shadow-[inset_0px_0px_10px_4px_rgba(43,72,241,0.20)] p-3 rounded-md shrink-0"
          >
            <img
              src="/images/category/ruler.png"
              class="w-4 h-4 lg:w-6 lg:h-6 md:w-5 md:h-5"
              alt=""
            />
          </div>
          <p class="text-base xl:text-lg font-medium">
            Функциональные решения:
            <span class="block text-sm xl:text-lg font-normal"
            >Компьютерные столы, перегородки, металлические сейфы и
              эргономичные вешалки – наши мебельные решения предлагают высший
              уровень функциональности.</span
            >
          </p>
        </div>
        <div class="flex items-start gap-2 bg-white p-3 shadow rounded">
          <div
            class="shadow-[inset_0px_0px_10px_4px_rgba(43,72,241,0.20)] p-3 rounded-md shrink-0"
          >
            <img
              src="/images/category/shelves.png"
              class="w-4 h-4 lg:w-6 lg:h-6 md:w-5 md:h-5"
              alt=""
            />
          </div>
          <p class="text-base xl:text-lg font-medium">
            Мобильные и модульные системы: 
            <span class="block text-sm xl:text-lg font-normal"
            >Модульные стеллажи, перегородки и мобильные секции обеспечивают
              гибкость в создании уникального офисного пространства.</span
            >
          </p>
        </div>
        <div class="flex items-start gap-2 bg-white p-3 shadow rounded">
          <div
            class="shadow-[inset_0px_0px_10px_4px_rgba(43,72,241,0.20)] p-3 rounded-md shrink-0"
          >
            <img
              src="/images/category/time.png"
              class="w-4 h-4 lg:w-6 lg:h-6 md:w-5 md:h-5"
              alt=""
            />
          </div>
          <p class="text-base xl:text-lg font-medium">
            Долгий срок службы:
            <span class="block text-sm xl:text-lg font-normal"
            >Использование массива дерева и металла гарантирует долгий срок
              службы мебели. Гарантия качества подтверждена отзывами наших
              клиентов.</span
            >
          </p>
        </div>
      </div>
    </section>

    <section class="mt-24">
      <!-- Двухколоночное размещение -->
      <div class="flex flex-col md:flex-row gap-20 lg:gap-32">
        <!-- Левая колонка -->
        <div class="w-full md:w-1/2 text-sm sm:text-[16px]">
          <h2 class="text-2xl font-bold mb-2">
            Офисная мебель руководителя - ассортимент
          </h2>
          <p class="mb-4">
            В отличие от рабочего места рядового офисного сотрудника, место,
            занимаемое руководителем, должно обладать более широкой
            функциональностью. Это не только рабочая зона, но и переговорная,
            где проводятся совещания, встречи с партнерами. Кроме того,
            немаловажную роль играет интерьер офиса. В нем должен отражаться
            фирменный стиль компании, максимальный комфорт, акцент на статусе
            владельца, сфере бизнеса. У нас представлена вся необходимая мебель
            для кабинета руководителя - классический стиль, модерн или хай тек –
            огромный выбор по умеренным ценам. Коллекция каталога разбита на
            следующие сегменты:
          </p>

          <!-- Список сегментов -->
          <ul class="list-disc pl-5 mb-4 text-sm sm:text-[16px]">
            <li>
              <span class="underline">Эконом.</span> Категория меблировки,
              которая позволяет экономно обставить кабинет руководителя;
            </li>
            <li>
              <span class="underline">Бизнес.</span> Здесь представлена мебель в
              кабинете руководителя с максимальной функциональностью, богатым
              разнообразием конфигураций;
            </li>
            <li>
              <span class="underline">Премиум.</span> Данный сегмент – это
              эксклюзивный стиль, уникальные дизайнерские решения, материалы
              экстра-класса.
            </li>
            <li>
              <span class="underline">Президент комплекты.</span> Люксовая серия
              кабинетов, предназначенная для высших чинов, глав компаний,
              президентов стран.
            </li>
          </ul>

          <!-- Многообразие комплектаций -->
          <p class="mb-4">
            Многообразие комплектаций мебели кабинетов руководителя:
          </p>
          <ul class="list-disc pl-5 mb-4 text-sm sm:text-[16px]">
            <li>
              письменные, компьютерные, рабочие столы различных форм,
              дизайнерских исполнений, цветовых решений;
            </li>
            <li>брифинг-приставки различных конфигураций;</li>
            <li>
              приставки подкатные – конструкции, которые отличаются не только
              функциональностью, но и мобильностью;
            </li>
            <li>
              <span class="underline">шкафы,</span>
              <span class="underline">стеллажи для документации,</span>
              позволяющие сортировать и хранить договора, бланки, акты и т.д.;
            </li>
            <li><span class="underline">шкафы для одежды;</span></li>
            <li>кренедении;</li>
            <li>
              вспомогательные элементы. Сюда входят
              <span class="underline">кресла,</span>
              <span class="underline">стулья,</span> кофейные столики,
              аксессуары.
            </li>
          </ul>

          <p class="mb-4">
            Мы поможем купить кабинет готовой комплектации или составить
            подборку по модулям, удовлетворяющую изысканным пожеланиям
            покупателей.
          </p>
        </div>

        <!-- Правая колонка -->
        <div class="w-full md:w-1/2 text-sm sm:text-[16px]">
          <h2 class="text-2xl font-bold mb-2">
            Комплекты мебели для кабинета руководителя покупать выгодно с
            компанией ООО Дары мебели
          </h2>
          <p class="mb-4">
            Наш интернет-магазин создан так, чтобы обеспечивать максимальное
            удобство выбора. Интуитивно понятный интерфейс, разработка
            продуманной навигации позволяет производить отбор по нескольким
            ключевым параметрам. Реалистичные фотографии готовых комплектов дают
            возможность оценить реальные габариты, сориентироваться в их
            стилевых направлениях еще на стадии просмотра каталога. Купить набор
            офисной мебели для руководителя сегодня - это просто, недорого, а
            главное удобно. Сделав заказ прямо сейчас, уже в ближайшее время вы
            сможете комфортно осуществлять руководство бизнесом, проводить
            встречи с партнерами или принимать иностранные делегации.
          </p>
        </div>
      </div>
    </section>
  </div>
</div>
