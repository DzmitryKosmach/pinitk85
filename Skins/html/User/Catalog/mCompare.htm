<?php echo CssCopmress::load('cart')?>

<div id="title" class="title">
  <!-- Хлебные крошки -->
  <nav class="text-sm text-gray-500 flex flex-wrap items-center gap-1 mb-6">
    <?php if(count($breadcrumbs)) { ?>
    <?php $bcLast = array_pop($breadcrumbs); ?>
    <?php $position = 0; ?>
    <?php foreach($breadcrumbs as $bc) { ?>
    <?php $position++; ?>
    <a href="<?php echo $bc['url']; ?>" class="hover:text-gray-700">
      <?php echo $bc['name']; ?>
    </a>
    <span class="mx-1">›</span>
    <?php } ?>
    <span class="text-gray-700"><?php echo $bcLast['name']; ?></span>
    <?php } ?>
  </nav>

  <!-- Заголовок -->
  <?php if(trim($pageInf['header'])) { ?>
  <h1 class="text-2xl font-bold mb-8"><?php echo $pageInf['header']; ?></h1>
  <?php } ?>
</div>

<div id="content" class="content p-4 md:p-6">
  <div class="">
    <div class="centeringin clearfix">

      <?php echo ($pageInf['seo_hide'] ? Url_SeoHide::parse($pageInf['text']) : $pageInf['text'])?>
      <div class="cl mb-6"></div>

      <?php if(count($series)) { ?>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-<?php echo count($series); ?> gap-6">
        <?php foreach($series as $s) { ?>
        <div class="bg-white border border-gray-200 rounded-lg shadow-sm p-5 flex flex-col">
          <!-- Артикул -->
          <div class="text-xs text-gray-500 mb-1">
            Артикул: <?php echo hsch($s['article'] ?? '—') ?>
          </div>
          <!-- Название -->
          <h3 class="font-bold text-xl mb-3">
            <?php echo hsch($s['name']) ?>
          </h3>
          <!-- Фото -->
          <div class="mb-4">
            <?php if($s['1st_photo']) { ?>
            <a href="<?php echo Catalog::photoUrl(
                    Catalog_Series_Photos::$imagePath,
                    $s['1st_photo']['id'], 0,0,0, $s['1st_photo']['_img_ext'],
                    $s['1st_photo']['name']
                  )?>" target="_blank" onclick="return hs.expand(this, {slideshowGroup: 'default'})">
              <img src="<?php echo Catalog::photoUrl(
                      Catalog_Series_Photos::$imagePath,
                      $s['1st_photo']['id'], 175, 110, $s['1st_photo']['rm'], $s['1st_photo']['_img_ext'],
                      $s['1st_photo']['name']
                    )?>" alt="<?php echo hsch($s['name'])?>" class="w-full h-auto object-contain max-h-48 mx-auto">
            </a>
            <?php } else { ?>
            <div class="w-full h-48 bg-gray-100 flex items-center justify-center text-gray-400">Нет фото</div>
            <?php } ?>
          </div>

          <!-- Характеристики -->
          <div class="space-y-2 text-sm">
            <!-- Цена -->
            <div>
              <span class="font-medium">Цена комплекта:</span>
              <span class="ml-2"><?php echo Catalog::priceFormat($s['price_min'])?> <span class="text-gray-600">р</span></span>
            </div>

            <!-- Опции -->
            <?php foreach($options as $optName => $series2val) { ?>
            <div>
              <span class="font-medium"><?php echo hsch($optName)?>:</span>
              <span class="ml-2"><?php echo hsch($series2val[$s['id']] ?? '—') ?></span>
            </div>
            <?php } ?>

            <!-- Цветовая гамма -->
            <div>
              <span class="font-medium">Цветовая гамма:</span>
              <span class="ml-2">
                    <?php if(count($matsBySeries[$s['id']])) { ?>
                <?php $mCnt = count($matsBySeries[$s['id']]) ?>
                <?php foreach($matsBySeries[$s['id']] as $mn => $mId) { ?>
                <?php $m = $materials[$mId]; ?>
                <?php if($m['image']['ext']) { ?>
                <a class="inline-block underline hover:text-blue-600 mr-1"
                   href="<?php echo Config::pathRel('images') . Catalog_Materials::$imagePath . $m['image']['id']; ?>.<?php echo $m['image']['ext']; ?>"
                   target="_blank"
                   onclick="return hs.expand(this, {slideshowGroup: 'default'})">
                            <?php echo hsch($m['name']) ?>
                          </a><?php echo ($mn == $mCnt-1 ? '' : ', ') ?>
                <?php } else { ?>
                <?php echo hsch($m['name']) ?><?php echo ($mn == $mCnt-1 ? '' : ', ') ?>
                <?php } ?>
                <?php } ?>
                <?php } else { ?>
                —
                <?php } ?>
                  </span>
            </div>
          </div>

          <!-- Кнопка удаления -->
          <div class="mt-auto pt-4">
            <a href="<?php echo Url::buildUrl(0, array('remove' => $s['id']))?>"
               class="text-red-600 hover:text-red-800 text-xs font-medium"
               title="Удалить из сравнения">
              Удалить из сравнения
            </a>
          </div>
        </div>
        <?php } ?>
      </div>
      <br /><br />
      <?php } ?>

      <?php if(!count($series)) { ?>
      <div class="p-6 bg-red-50 border border-red-200 rounded-md text-red-700">
        <?php echo Pages::msgErr('Нет серий, выбранных для сравнения.')?>
      </div>
      <?php } ?>
    </div>
  </div>
</div>
