<?php echo CssCopmress::load('catalog')?>
<?php echo JsCopmress::load('catalog')?>

<?php echo CssCopmress::load('series')?>
<?php echo JsCopmress::load('series')?>

<script>
  oCompare.url = '<?php echo Url::a('catalog-compare'); ?>';
</script>

<script>
  oMaterials.tree = AJAX.jsonDecode('<?php echo str_replace('\'', '\\\'', toJson($materials)) ?> ');
</script>



<div itemscope itemtype="http://schema.org/Product" id="content" class="content">
  <meta itemprop="brand" content="<?php echo $pageInf['header']; ?>">
  <meta itemprop="url"
        content="<?php echo ((!empty($_SERVER['HTTPS'])) ? 'https' : 'http') . '://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']; ?>">
  <div>
    <div>

      <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
      <nav class="text-sm text-gray-500 flex flex-wrap items-center gap-1 mb-10">
        <?php if(count($breadcrumbs)) { ?>
        <?php $bcLast = array_pop($breadcrumbs); ?>
        <?php $position = 0; ?>
        <?php foreach($breadcrumbs as $bc) { ?>
        <?php $position = $position + 1; ?>
        <a href="<?php echo $bc['url']; ?>" class="hover:text-gray-700">
          <?php echo $bc['name']; ?>
        </a>
        <span class="mx-1">‚Ä∫</span>
        <?php } ?>
        <span class="text-gray-700">
                    <?php echo $bcLast['name']; ?>
                </span>
        <?php } ?>
      </nav>


      <!-- –ë–ª–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –∫–Ω–æ–ø–∫–∞–º–∏ (md) -->
      <div class="md:hidden block">
        <div class="flex items-center justify-between">
          <div class="flex gap-4 items-center mt-auto text-gray-500 text-sm mb-3">
            <button class="hover:opacity-50">
              <img src="/images/index/izbr_small.png" </button>
            <button class="hover:opacity-50">
              <div class="threeblock clearfix">
                <div class="compare">

                  <!-- –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é" -->
                  <div class="series-compare-add <?php if (Catalog_Compare::check($seriesInf['id'])): ?>hidden<?php endif; ?>" data-id="<?php echo (int)$seriesInf['id']; ?>">
                    <a rel="nofollow" class="add2compare" href="javascript:void(0)"
                       onclick="oCompare.add(<?php echo $seriesInf['id']; ?>); return false;">
                      <svg width="26" height="26" viewBox="0 0 34 34" fill="none"
                           xmlns="http://www.w3.org/2000/svg">
                        <path d="M4.25 16.9987H7.08333V29.7487H4.25V16.9987ZM26.9167 11.332H29.75V29.7487H26.9167V11.332ZM15.5833 2.83203H18.4167V29.7487H15.5833V2.83203Z" fill="#3C3C3A" />
                      </svg>
                    </a>
                  </div>

                  <!-- –ö–Ω–æ–ø–∫–∞ "–£–±—Ä–∞—Ç—å –∏–∑ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è" -->
                  <div class="series-compare-remove <?php if (!Catalog_Compare::check($seriesInf['id'])): ?>hidden<?php endif; ?>" data-id="<?php echo (int)$seriesInf['id']; ?>">
                    <a rel="nofollow" class="add2compare" href="javascript:void(0)"
                       onclick="oCompare.remove(<?php echo $seriesInf['id']; ?>); return false;">
                      <svg width="26" height="26" viewBox="0 0 34 34" fill="none"
                           xmlns="http://www.w3.org/2000/svg">
                        <g stroke="#FF0000" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round" transform="translate(8,0)">
                          <line x1="13" y1="2" x2="21" y2="10" />
                          <line x1="21" y1="2" x2="13" y2="10" />
                        </g>
                        <g transform="translate(0,3)">
                          <path d="M4.25 16.9987H7.08333V29.7487H4.25V16.9987ZM26.9167 11.332H29.75V29.7487H26.9167V11.332ZM15.5833 2.83203H18.4167V29.7487H15.5833V2.83203Z" fill="#3C3C3A" />
                        </g>
                      </svg>
                    </a>
                  </div>
                </div>
                <?php $fc = trim(Options::name('found-cheaper')); ?>
                <?php if($fc !== '' && $fc !== '&nbsp;') { ?>

                <?php } ?>
              </div>
            </button>
          </div>
          <div class="flex gap-4 items-center mt-auto text-gray-500 text-sm mb-3">
            <button class="hover:opacity-50">&lt; –ü—Ä–µ–¥.—Ç–æ–≤–∞—Ä</button>
            <button class="hover:opacity-50">–°–ª–µ–¥.—Ç–æ–≤–∞—Ä &gt;</button>
          </div>
        </div>

        <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
        <h1 class="text-2xl font-bold leading-snug mb-3">
          <?php echo $seriesInf['name']; ?><br class="hidden md:inline" />
          <!--          <?php echo $pageInf['header']; ?>-->
        </h1>

      </div>

      <div class="flex flex-col sm2:flex-row gap-12">
        <?php if(count($photos)) { ?>
        <div class="sm2:w-1/2">
          <div class="flex lg:flex-row flex-col-reverse gap-4">
            <!-- –ì–∞–ª–µ—Ä–µ—è –º–∏–Ω–∏–∞—Ç—é—Ä —Å –∫–Ω–æ–ø–∫–∞–º–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ -->
            <div class="slider-thumbnails-container">
              <div class="flex flex-row lg:flex-col justify-center items-center gap-2 max-h-[500px] overflow-hidden">
                <!-- –ö–Ω–æ–ø–∫–∞ "–≤–≤–µ—Ä—Ö / –≤–ª–µ–≤–æ" -->
                <button type="button"
                        class="slider-prev text-gray-600 hover:text-black focus:outline-none"
                        aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 rotate-[-90deg] lg:rotate-0"
                       fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M5 15l7-7 7 7" />
                  </svg>
                </button>

                <!-- –°–ª–∞–π–¥–µ—Ä –º–∏–Ω–∏–∞—Ç—é—Ä -->
                <div class="slider-track flex flex-row lg:flex-col gap-2 overflow-x-auto lg:overflow-y-auto max-h-full max-w-full lg:max-w-[80px] scroll-smooth snap-x snap-mandatory lg:snap-y scrollbar-none"
                     style="scroll-behavior: smooth; -webkit-overflow-scrolling: touch; scroll-snap-type: x mandatory;">
                  <?php foreach($photos as $pn => $p): ?>
                  <img
                    src="<?php echo Catalog::photoUrl(Catalog_Series_Photos::$imagePath, $p['id'], 90, 90, $p['rm'], $p['_img_ext']); ?>"
                    data-bigimage="<?php echo Catalog::photoUrl(Catalog_Series_Photos::$imagePath, $p['id'], 0, 0, 0, $p['_img_ext']); ?>"
                    alt="<?php echo hsch($p['alt'] ?: $catInf['name'] . ' ' . $seriesInf['name'] . ($pn > 0 ? ' - —Ñ–æ—Ç–æ ' . ($pn + 1) : '')); ?>"
                    title="<?php echo hsch($p['alt'] ?: $catInf['name'] . ' ' . $seriesInf['name'] . ($pn > 0 ? ' - —Ñ–æ—Ç–æ ' . ($pn + 1) : '')); ?>"
                    class="w-20 h-20 object-cover rounded border flex-shrink-0 snap-start cursor-pointer transition-transform hover:scale-105"
                    onclick="changeMainImage(this)"
                  />
                  <?php endforeach; ?>
                </div>

                <!-- –ö–Ω–æ–ø–∫–∞ "–≤–Ω–∏–∑ / –≤–ø—Ä–∞–≤–æ" -->
                <button type="button"
                        class="slider-next text-gray-600 hover:text-black focus:outline-none"
                        aria-label="–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 rotate-90 lg:rotate-180"
                       fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M5 15l7-7 7 7" />
                  </svg>
                </button>
              </div>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
            <div id="section-photo" class="w-full relative">
              <?php $p = $photos[0]; ?>
              <div class="relative w-full" id="mainImageContainer">

                <img
                  src="<?php echo Catalog::photoUrl(Catalog_Series_Photos::$imagePath, $p['id'], 0, 0, 0, $p['_img_ext']); ?>"
                  alt="<?php echo hsch($p['alt'] ? $p['alt'] : $catInf['name'] . ' ' . $seriesInf['name']); ?>"
                  title="<?php echo hsch($p['alt'] ? $p['alt'] : $catInf['name'] . ' ' . $seriesInf['name']); ?>"
                  class="w-full aspect-[578/409] rounded-xl object-cover cursor-zoom-in"
                  id="main-product-image"
                />

                <!-- –¢–æ—á–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π-->
                <?php if(count($seriesSet)) { ?>
                <div id="infoDots" class="series-set-points absolute top-0 bottom-0 left-0 right-0 z-20">
                  <?php foreach($seriesSet as $in => $i) { ?>
                  <?php
												$seriesSetItemsIds[] = $i['id'];
												//$seriesInf = ($i['series_id'] == $seriesOrig['id'] ? $seriesOrig : $crossSeries[$i['series_id']]);
											?>
                  <?php if(!$i['on_series_photo']) continue; ?>

                  <!--                    <div-->
                  <!--                      id="series-set-point-<?php echo $i['id']; ?>"-->
                  <!--                      class="absolute flex flex-row items-center justify-start space-x-2 px-2 py-1 bg-white border border-gray-300 bg-opacity-90 rounded-md z-30 text-xs font-medium text-black whitespace-nowrap pointer-events-none"-->
                  <!--                      style="left: <?php echo round(100*$i['on_series_photo_x']/Catalog_Series_SetItems::SET_IMAGE_DEFAULT_W, 4)?>%; top: <?php echo round(100*$i['on_series_photo_y']/Catalog_Series_SetItems::SET_IMAGE_DEFAULT_H, 4)?>%;"-->
                  <!--                      onclick="showItemPopup2('<?php echo Catalog_Items::a($seriesInf, $i)?>', <?php echo $i['id']; ?>); return handleOnclick(event);"-->
                  <!--                      onmouseover="seriesSetHoverPoint(<?php echo $i['id']; ?>, true)"-->
                  <!--                      onmouseout="seriesSetHoverPoint(<?php echo $i['id']; ?>, false)"-->
                  <!--                    >-->
                  <!-- –û–±—â–∞—è –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
                  <div class="absolute" style="
                      left: <?php echo round(100*$i['on_series_photo_x']/Catalog_Series_SetItems::SET_IMAGE_DEFAULT_W, 4)?>%;
                      top: <?php echo round(100*$i['on_series_photo_y']/Catalog_Series_SetItems::SET_IMAGE_DEFAULT_H, 4)?>%;
                      width: 28px;
                      height: 28px;
                      transform: translate(-50%, -50%);
                      pointer-events: none;
                    ">
                    <!-- SVG ‚Äî –í–°–ï–ì–î–ê –≤–∏–¥–µ–Ω -->
                    <svg
                      id="svg-point-<?php echo $i['id']; ?>"
                      width="28"
                      height="28"
                      viewBox="0 0 50 50"
                      class="absolute pointer-events-auto cursor-pointer z-30"
                      style="
                          left: <?php echo round(100*$i['on_series_photo_x']/Catalog_Series_SetItems::SET_IMAGE_DEFAULT_W, 4)?>%;
                          top: <?php echo round(100*$i['on_series_photo_y']/Catalog_Series_SetItems::SET_IMAGE_DEFAULT_H, 4)?>%;
                          transform: translate(-50%, -50%);
                          filter: drop-shadow(2px 3px 3px rgba(0,0,0,0.3));
                        "
                      onmouseover="showLabel2(<?php echo $i['id']; ?>)"
                      onmouseout="hideLabel2(<?php echo $i['id']; ?>)"
                      onclick="showItemPopup2('<?php echo Catalog_Items::a($seriesInf, $i)?>', <?php echo $i['id']; ?>); return handleOnclick(event);"
                    >
                      <circle cx="25" cy="25" r="16" fill="white" />
                      <circle cx="25" cy="25" r="14" fill="#2563eb" />
                    </svg>

                    <!-- –ü–æ–¥–ø–∏—Å—å ‚Äî –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ hover -->
                    <div
                      id="series-set-point2-<?php echo $i['id']; ?>"
                      class="absolute ml-3 w-[200px] md:w-[360px] flex flex-wrap flex-row items-center space-x-2 px-2 py-1 bg-white border border-gray-300 bg-opacity-90 rounded-md z-40 text-xs font-medium text-black
                            opacity-0 pointer-events-none transition-opacity duration-200
                            whitespace-normal break-words"
                      style="
                        left: <?php echo round(100*$i['on_series_photo_x']/Catalog_Series_SetItems::SET_IMAGE_DEFAULT_W, 4) + 2 ?>%;
                        top: <?php echo round(100*$i['on_series_photo_y']/Catalog_Series_SetItems::SET_IMAGE_DEFAULT_H, 4) ?>%;
                        transform: translate(0, -50%);
                      "
                      onmouseout="hideLabel(<?php echo $i['id']; ?>)"
                    >
                  <span class="leading-none">
                    <span class="font-semibold"><?php echo hsch($i['name']); ?></span>
                    <?php if (!empty($i['art'])): ?>
                    <span> <?php echo hsch($i['art']); ?></span>
                    <?php endif; ?>
                    <?php if (!is_null($i['size']) && trim($i['size']) !== ''): ?>
                    <span> (<?php echo hsch($i['size']); ?>)</span>
                    <?php endif; ?>
                  </span>
                    </div>
                  </div>
                  <?php } ?>
                </div>
                <?php } ?>



                <script>
                  // –ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Å—å –±–ª–æ–∫ (div)
                  function showLabel2(id) {
                    const container = document.getElementById('series-set-point2-' + id);
                    if (container) {
                      container.classList.remove('opacity-0', 'pointer-events-none');
                      container.classList.add('opacity-100', 'pointer-events-auto');
                    }
                  }

                  // –°–∫—Ä—ã—Ç—å –≤–µ—Å—å –±–ª–æ–∫ (div)
                  function hideLabel2(id) {
                    const container = document.getElementById('series-set-point2-' + id);
                    if (container) {
                      container.classList.remove('opacity-100', 'pointer-events-auto');
                      container.classList.add('opacity-0', 'pointer-events-none');
                    }
                  }
                </script>

                <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ -->
                <div class="modal-overlay hidden fixed inset-0 bg-black bg-opacity-75 z-50 items-center justify-center p-4">
                  <img src="" alt="–£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ"
                       class="max-w-full max-h-full object-contain transition-all duration-300 scale-95 opacity-0"
                       id="zoomedImage" />
                </div>
              </div>


            </div>

            <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (—Å–∫—Ä—ã—Ç–æ–µ) -->
            <div id="series-modal" class="fancyimages noned hidden"  title="<?php echo hsch($seriesInf['name'])?>">
              <div class="fancygallery">
                <table class="changegenimage">
                  <tbody>
                  <tr>
                    <td class="image">
                      <?php
											$p = $photos[0];
											?>
                      <img class="max genimage" src="<?php echo Catalog::photoUrl(
													 Catalog_Series_Photos::$imagePath,
													 $p['id'], 0, 0, 0, $p['_img_ext'], [$catInf['url'], $seriesInf['url']]
												 )?>" alt="<?php echo hsch($p['alt'] ? $p['alt'] : $catInf['name'] . ' ' . $seriesInf['name'])?>"
                           title="<?php echo hsch($p['alt'] ? $p['alt'] : $catInf['name'] . ' ' . $seriesInf['name'])?>"
                      <?php /*style="max-width: 800px" */?>
                      >
                    </td>
                    <td class="slider">
                      <div class="picslider scrollp vertical">
                        <a rel="nofollow" class="scrollbtn prev pop" href="#">
                          <i class="icon pngicons"></i>
                        </a>
                        <div class="popd_jscrollpane scroll vertical-only max"
                             id="d_scroll_popup_<?php echo $seriesInf['id']; ?>">
                          <div class="scrollinner">
                            <?php
                                                        foreach($photos as $pn => $p) {
                            $p['alt'] = !is_null($p['alt']) ? $p['alt'] : '';
                            $altName = hsch(trim($p['alt']) ? $p['alt'] : $catInf['name'] . ' ' . $seriesInf['name']);
                            ?>
                            <a rel="nofollow"
                               class="changeimage scrollitem<?php if($pn==0) { ?> imgoffer imgofferid<?php echo $p['id']; ?><?php } ?>"
                               href="#">
                              <img src="<?php echo Catalog::photoUrl(
																		Catalog_Series_Photos::$imagePath,
																		$p['id'], 90, 90, $p['rm'], $p['_img_ext']
																	)?>" alt="<?php echo $altName . hsch(($pn > 0 ? ' - —Ñ–æ—Ç–æ' . ($pn+1) : '')); ?>"
                                   title="<?php echo $altName . hsch(($pn > 0 ? ' - —Ñ–æ—Ç–æ' . ($pn+1) : '')); ?>"
                                   data-bigimage="<?php echo Catalog::photoUrl(
																		Catalog_Series_Photos::$imagePath,
																		$p['id'], 0, 0, 0, $p['_img_ext'], [$catInf['url'], $seriesInf['url']]
																	)?>">
                            </a>
                            <?php } ?>
                          </div>
                        </div>
                        <a rel="nofollow" class="scrollbtn next pop" href="#">
                          <i class="icon pngicons"></i>
                        </a>
                      </div>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥ –≥–∞–ª–µ—Ä–µ–µ–π -->
          <div class="bg-white py-4 px-8 rounded-lg shadow-md mt-10" id="series-block">
            <div class="relative">
              <div id="series-text">
                <p class="text-lg leading-6 overflow-hidden transition-all duration-300">
                  <?php echo $seriesInf['text']; ?>
                </p>
              </div>

              <!-- –ì—Ä–∞–¥–∏–µ–Ω—Ç -->
              <div id="fade-gradient"
                   class="absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-white to-transparent pointer-events-none hidden"></div>

              <a id="read-more-btn"
                 class="inline-block text-gray-600 mt-2 cursor-pointer hidden relative z-10">
                –ß–∏—Ç–∞—Ç—å –≤—Å–µ
              </a>
            </div>
          </div>

          <script>
            // –ß–∏—Ç–∞—Ç—å –≤—Å–µ
            document.addEventListener('DOMContentLoaded', () => {
              const text = document.getElementById('series-text');
              const btn = document.getElementById('read-more-btn');
              const gradient = document.getElementById('fade-gradient');
              const block = document.getElementById('series-block');

              if (!text) return;

              const maxLines = 3;
              let maxHeight = 0;

              const updateHeights = () => {
                const computed = window.getComputedStyle(text);
                let lineHeight = parseFloat(computed.lineHeight);

                if (isNaN(lineHeight)) {
                  const tempSpan = document.createElement('span');
                  tempSpan.style.visibility = 'hidden';
                  tempSpan.style.font = computed.font;
                  tempSpan.textContent = 'Hg';
                  document.body.appendChild(tempSpan);
                  const rect = tempSpan.getBoundingClientRect();
                  lineHeight = rect.height;
                  document.body.removeChild(tempSpan);
                }

                maxHeight = lineHeight * maxLines;
                return maxHeight;
              };

              const checkTruncation = () => {
                updateHeights();
                setTimeout(() => {
                  const realHeight = text.scrollHeight;
                  if (realHeight > maxHeight) {
                    text.style.maxHeight = maxHeight + 'px';
                    text.style.overflow = 'hidden';
                    btn.classList.remove('hidden');
                    gradient.classList.remove('hidden');
                  }
                }, 0);
              };

              checkTruncation();

              // –ö–Ω–æ–ø–∫–∞
              btn.addEventListener('click', () => {
                if (text.style.maxHeight && text.style.maxHeight !== 'none') {
                  // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º
                  text.style.maxHeight = 'none';
                  btn.textContent = '–°–≤–µ—Ä–Ω—É—Ç—å';
                  gradient.classList.add('hidden');
                } else {
                  // –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º
                  text.style.maxHeight = maxHeight + 'px';
                  btn.textContent = '–ß–∏—Ç–∞—Ç—å –≤—Å–µ';
                  gradient.classList.remove('hidden');

                  // –°–∫—Ä–æ–ª–ª–∏–º —Å –æ—Ç—Å—Ç—É–ø–æ–º 80px –æ—Ç –≤–µ—Ä—Ö–∞
                  const top = block.getBoundingClientRect().top + window.scrollY - 80;
                  window.scrollTo({ top, behavior: 'smooth' });
                }
              });
            });
          </script>


        </div>

        <!-- JavaScript –¥–ª—è —Å–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
        <script>
          // –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
          function changeMainImage(thumb) {
            const mainImg = document.getElementById('main-product-image');
            const infoDots = document.getElementById('infoDots'); // –∏–ª–∏ 'series-set-points', –µ—Å–ª–∏ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è
            const bigImage = thumb.dataset.bigimage;
            const alt = thumb.alt;

            // –ú–µ–Ω—è–µ–º –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            if (mainImg && bigImage) {
              mainImg.src = bigImage;
              mainImg.alt = alt;
            }

            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –º–∏–Ω–∏–∞—Ç—é—Ä—ã
            const thumbnails = document.querySelectorAll('.slider-track img');

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π –º–∏–Ω–∏–∞—Ç—é—Ä—ã
            const thumbIndex = Array.from(thumbnails).indexOf(thumb);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ—á–∫–∏ –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –ø–µ—Ä–≤–∞—è –º–∏–Ω–∏–∞—Ç—é—Ä–∞
            if (thumbIndex === 0) {
              infoDots.classList.remove('hidden'); // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º
            } else {
              infoDots.classList.add('hidden');    // —Å–∫—Ä—ã–≤–∞–µ–º
            }

            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –º–∏–Ω–∏–∞—Ç—é—Ä—ã
            thumbnails.forEach(img => {
              img.classList.remove('border-blue-600');
            });
            thumb.classList.add('border-blue-600');
          }

          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
          document.addEventListener('DOMContentLoaded', function () {
            const firstThumb = document.querySelector('.slider-track img');
            if (firstThumb) {
              changeMainImage(firstThumb);
            }

            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –º–∏–Ω–∏–∞—Ç—é—Ä –ø—Ä–∏ –∫–ª–∏–∫–µ
            document.querySelectorAll('.slider-track img').forEach(img => {
              img.addEventListener('click', function () {
                changeMainImage(this);
              });
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è fancybox –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            // if (typeof $.fancybox !== 'undefined') {
            //   $('[data-fancybox]').fancybox({
            //     animationEffect: "zoom",
            //     transitionEffect: "slide",
            //     buttons: ["close"],
            //     thumbs: { autoStart: true },
            //     loop: true,
            //     clickContent: false
            //   });
            // }
          });

          // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—ã—Å–æ—Ç—ã —Å–ª–∞–π–¥–µ—Ä–∞ –º–∏–Ω–∏–∞—Ç—é—Ä
          function updateThumbnailSliderHeight() {
            // üîπ –ü—Ä–æ–≤–µ—Ä—è–µ–º —à–∏—Ä–∏–Ω—É —ç–∫—Ä–∞–Ω–∞
            if (window.innerWidth < 1024) {
              // –ù–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ–º
              const track = document.querySelector('.slider-track');
              const container = document.querySelector('.slider-thumbnails-container');

              if (track) {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∏–ª–∏, –∑–∞–¥–∞–Ω–Ω—ã–µ JS
                track.style.maxHeight = '';
                track.style.height = '';
              }
              if (container) {
                container.style.height = '';
                container.style.maxHeight = '';
              }

              // –í—Å—ë —Ä–∞–≤–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∑–º–µ–Ω–∏–ª—Å—è –∏–∑-–∑–∞ —Ä–µ—Å–∞–π–∑–∞)
              updateButtons();
              return;
            }

            // üîπ –ù–∞ –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö ‚Äî –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–¥ –≤—ã—Å–æ—Ç—É –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const mainImage = document.querySelector('.w-full > img');
            const container = document.querySelector('.slider-thumbnails-container');
            const track = container?.querySelector('.slider-track');
            const btnPrev = container?.querySelector('.slider-prev');
            const btnNext = container?.querySelector('.slider-next');

            if (!mainImage || !container || !track || !btnPrev || !btnNext) {
              updateButtons(); // –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ–ø—Ä–æ–±—É–µ–º –æ–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏
              return;
            }

            const imageRect = mainImage.getBoundingClientRect();
            const imageHeight = imageRect.height;

            if (imageHeight <= 0) {
              updateButtons();
              return;
            }

            const btnHeight = btnPrev.offsetHeight;
            const totalButtonsHeight = btnHeight * 2;
            const gap = 24; // gap-6 –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏ –∏ —Ç—Ä–µ–∫–æ–º

            const desiredTrackHeight = imageHeight - totalButtonsHeight - gap;

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É —Ç—Ä–µ–∫–∞
            if (desiredTrackHeight > 100) {
              track.style.maxHeight = `${desiredTrackHeight}px`;
              track.style.height = `${desiredTrackHeight}px`;
            } else {
              track.style.maxHeight = '400px';
              track.style.height = '400px';
            }

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¢–û–õ–¨–ö–û –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ
            container.style.height = `${imageHeight}px`;
            container.style.maxHeight = `${imageHeight}px`;

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
            updateButtons();
          }

          // –í—ã–∑–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
          window.addEventListener('load', () => {
            updateThumbnailSliderHeight();
            updateButtons(); // —Ç–≤–æ—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫
          });

          // –ü—Ä–∏ —Ä–µ—Å–∞–π–∑–µ
          window.addEventListener('resize', () => {
            updateThumbnailSliderHeight();
            updateButtons();
          });

          // –ï—Å–ª–∏ –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ–∑–∂–µ
          document.querySelector('.w-full > img')?.addEventListener('load', updateThumbnailSliderHeight);

          // --------------------------------------------

          // –ú–æ–¥–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
          document.addEventListener("DOMContentLoaded", () => {
            const mainImageContainer = document.getElementById("mainImageContainer");
            const mainImage = document.getElementById("main-product-image");
            const modalOverlay = document.querySelector(".modal-overlay");
            const zoomedImage = document.getElementById("zoomedImage");

            // –û—Ç–∫—Ä—ã—Ç–∏–µ
            mainImageContainer.addEventListener("click", () => {
              if (modalOverlay.classList.contains("flex")) return;

              // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º src
              zoomedImage.src = mainImage.src;

              // 1. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π (–Ω–æ –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ–∫–∞)
              modalOverlay.classList.remove("hidden");
              modalOverlay.classList.add("flex");

              // 2. –û–±–Ω—É–ª—è–µ–º —Å—Ç–∏–ª—å, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏
              zoomedImage.classList.remove("scale-100", "opacity-100");
              zoomedImage.classList.add("scale-95", "opacity-0");

              // 3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π reflow ‚Äî –∑–∞—Å—Ç–∞–≤–ª—è–µ–º –±—Ä–∞—É–∑–µ—Ä "—É–≤–∏–¥–µ—Ç—å" –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
              zoomedImage.offsetHeight; // —ç—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç reflow

              // 4. –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ—è–≤–ª–µ–Ω–∏—è
              requestAnimationFrame(() => {
                zoomedImage.classList.remove("scale-95", "opacity-0");
                zoomedImage.classList.add("scale-100", "opacity-100");
              });
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ
            function closeModal() {
              // –£–±–∏—Ä–∞–µ–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ
              zoomedImage.classList.remove("scale-100", "opacity-100");
              zoomedImage.classList.add("scale-95", "opacity-0");

              // –ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
              setTimeout(() => {
                modalOverlay.classList.remove("flex");
                modalOverlay.classList.add("hidden");
                zoomedImage.src = ""; // –æ—á–∏—â–∞–µ–º
              }, 300);
            }

            // –ö–ª–∏–∫ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ—Ç
            zoomedImage.addEventListener("click", (e) => {
              e.stopPropagation();
              closeModal();
            });

            // –ö–ª–∏–∫ –ø–æ —Ñ–æ–Ω—É ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ—Ç
            modalOverlay.addEventListener("click", closeModal);

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –Ω–∞ Escape (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ)
            window.addEventListener("keydown", (e) => {
              if (e.key === "Escape" && modalOverlay.classList.contains("flex")) {
                closeModal();
              }
            });
          });
        </script>
        <?php } ?>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –û–ø–∏—Å–∞–Ω–∏–µ –∏ —Ü–µ–Ω—ã -->
        <div class="info sm2:w-1/2">
          <!-- –ë–ª–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –∫–Ω–æ–ø–∫–∞–º–∏ -->
          <div class="md:block hidden">
            <div class="flex items-center justify-between">
              <div class="flex gap-4 items-center mt-auto text-gray-500 text-sm mb-3">
                <button class="hover:opacity-50">
                  <img src="/images/index/izbr_small.png" </button>
                <button class="hover:opacity-50">
                  <div class="threeblock clearfix">
                    <div class="compare">

                      <!-- –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é" -->
                      <div class="series-compare-add <?php if (Catalog_Compare::check($seriesInf['id'])): ?>hidden<?php endif; ?>" data-id="<?php echo (int)$seriesInf['id']; ?>">
                        <a rel="nofollow" class="add2compare" href="javascript:void(0)"
                           onclick="oCompare.add(<?php echo $seriesInf['id']; ?>); return false;">
                          <svg width="26" height="26" viewBox="0 0 34 34" fill="none"
                               xmlns="http://www.w3.org/2000/svg">
                            <path d="M4.25 16.9987H7.08333V29.7487H4.25V16.9987ZM26.9167 11.332H29.75V29.7487H26.9167V11.332ZM15.5833 2.83203H18.4167V29.7487H15.5833V2.83203Z" fill="#3C3C3A" />
                          </svg>
                        </a>
                      </div>

                      <!-- –ö–Ω–æ–ø–∫–∞ "–£–±—Ä–∞—Ç—å –∏–∑ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è" -->
                      <div class="series-compare-remove <?php if (!Catalog_Compare::check($seriesInf['id'])): ?>hidden<?php endif; ?>" data-id="<?php echo (int)$seriesInf['id']; ?>">
                        <a rel="nofollow" class="add2compare" href="javascript:void(0)"
                           onclick="oCompare.remove(<?php echo $seriesInf['id']; ?>); return false;">
                          <svg width="26" height="26" viewBox="0 0 34 34" fill="none"
                               xmlns="http://www.w3.org/2000/svg">
                            <g stroke="#FF0000" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round" transform="translate(8,0)">
                              <line x1="13" y1="2" x2="21" y2="10" />
                              <line x1="21" y1="2" x2="13" y2="10" />
                            </g>
                            <g transform="translate(0,3)">
                              <path d="M4.25 16.9987H7.08333V29.7487H4.25V16.9987ZM26.9167 11.332H29.75V29.7487H26.9167V11.332ZM15.5833 2.83203H18.4167V29.7487H15.5833V2.83203Z" fill="#3C3C3A" />
                            </g>
                          </svg>
                        </a>
                      </div>
                    </div>
                    <?php $fc = trim(Options::name('found-cheaper')); ?>
                    <?php if($fc !== '' && $fc !== '&nbsp;') { ?>

                    <?php } ?>
                  </div>
                </button>
              </div>
              <div class="flex gap-4 items-center mt-auto text-gray-500 text-sm mb-3">
                <button class="hover:opacity-50">&lt; –ü—Ä–µ–¥.—Ç–æ–≤–∞—Ä</button>
                <button class="hover:opacity-50">–°–ª–µ–¥.—Ç–æ–≤–∞—Ä &gt;</button>
              </div>
            </div>

            <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
            <h1 class="text-2xl font-bold leading-snug mb-3">
              <?php echo $pageInf['header']; ?>
            </h1>

          </div>

          <div id="series-set" class="flex flex-col gap-4">
            <!-- –¢–∞–±—ã -->
            <div class="flex gap-2 text-sm">
              <button
                class="tab-btn
           px-4 py-2 rounded-lg bg-blue-600 text-white font-medium
           shadow-[0_0_8px_rgba(59,130,246,0.3)]
           hover:shadow-[0_0_12px_rgba(59,130,246,0.4)]
           active:translate-y-[-1px]
           transition-all duration-200 ease-in-out"
                data-target="section-photo">
                –ú–µ–±–µ–ª—å –Ω–∞ —Ñ–æ—Ç–æ
              </button>

              <button
                class="tab-btn break-all
           px-4 py-2 rounded-lg bg-white border border-gray-200
           shadow-[0_0_8px_rgba(0,0,0,0.1)] text-gray-700 font-medium
           hover:shadow-[0_0_12px_rgba(0,0,0,0.15)] hover:border-gray-300
           active:translate-y-[-1px]
           transition-all duration-200 ease-in-out"
                data-target="section-specs">
                –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
              </button>

              <button
                class="tab-btn
           px-4 py-2 rounded-lg bg-white border border-gray-200
           shadow-[0_0_8px_rgba(0,0,0,0.1)] text-gray-700 font-medium
           hover:shadow-[0_0_12px_rgba(0,0,0,0.15)] hover:border-gray-300
           active:translate-y-[-1px]
           transition-all duration-200 ease-in-out"
                data-target="section-prices">
                –¶–µ–Ω—ã –Ω–∞ —Ç–æ–≤–∞—Ä—ã
              </button>
            </div>

            <script>
              document.querySelectorAll('.tab-btn').forEach(button => {
                button.addEventListener('click', function () {
                  // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö
                  document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active', 'bg-blue-600', 'text-white');
                    btn.classList.add('bg-white', 'text-gray-700');
                  });

                  // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –Ω–∞–∂–∞—Ç–æ–π
                  this.classList.add('active', 'bg-blue-600', 'text-white');
                  this.classList.remove('bg-white', 'text-gray-700');

                  // –ü–æ–ª—É—á–∞–µ–º —Ü–µ–ª–µ–≤–æ–π –±–ª–æ–∫
                  const targetId = this.getAttribute('data-target');
                  const targetElement = document.getElementById(targetId);

                  if (targetElement) {
                    // –ü–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª
                    targetElement.scrollIntoView({
                      behavior: 'smooth',
                      block: 'start'
                    });
                  }
                });
              });
            </script>

            <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
            <div class="ajaxpages_gmci w-full">
              <div class="artables w-full table clearfix">
                <div class="arproducts w-full space-y-2">
                  <?php
                                    $seriesOrig = $seriesInf;
                                    $seriesSetItemsIds = array();
                                    $offer_price = 0;
                                    ?>
                  <?php foreach($seriesSet as $in => $i) { ?>
                  <?php
                                    $seriesSetItemsIds[] = $i['id'];
                                    $seriesInf = ($i['series_id'] == $seriesOrig['id'] ? $seriesOrig : $crossSeries[$i['series_id']]);
                                    $offer_price += (str_replace(" ", '', Catalog::priceFormat($i['price_min'])) * $i['in_series_set_amount']);
                                    ?>

                  <style>
                    .series-item {
                      opacity: 1;
                      max-height: 500px; /* –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ª—é–±–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
                      overflow: hidden;
                      transition: all 0.4s ease-in-out;
                    }

                    .series-item.hidden {
                      opacity: 0;
                      max-height: 0;
                      margin: 0;
                      padding: 0;
                      border-width: 0;
                      transform: scaleY(0.8);
                    }
                  </style>
                  <div id="series-set-row-<?php echo $i['id']; ?>"
                       onmouseover="seriesSetHoverTable(<?php echo $i['id']; ?>, true)"
                       onmouseout="seriesSetHoverTable(<?php echo $i['id']; ?>, false)"
                  <?php if($in >= 3) { ?>class="series-item hidden"<?php } else { ?>class="series-item"<?php } ?>
                  class="flex flex-col gap-[6px] p-3 rounded-lg border border-gray-200
                  hover:shadow-sm transition"
                  >
                  <div class="flex flex-row justify-between items-center">
                    <div>
                      <p class="flex flex-col text-sm font-medium cursor-pointer"
                         onclick="showItemPopup2('<?php echo Catalog_Items::a($seriesInf, $i)?>', <?php echo $i['id']; ?>); return false;">
                        <?php echo $i['name']; ?>
                        <?php echo $i['art']; ?>
                        <?php if(!is_null($i['size']) && trim($i['size']) !== '') { ?>
                        <span class="text-xs text-gray-500">(
                          <?php echo $i['size']; ?>)
                                                    </span>
                        <?php } ?>
                      </p>
                    </div>

                    <div class="flex flex-wrap lg:flex-nowrap justify-end items-center gap-4">


                      <?php
							        foreach($i['materials'] as $n => $im){
                      if(!isset($materials[$im['material_id']])){
                      unset($i['materials'][$n]);
                      }
                      }
                      $i['materials'] = array_values($i['materials']);
                      $mActive = false;
                      if(count($i['materials'])) {
                      $mActive = $materials[$i['price_min_material_id']];
                      $mActiveName = array($mActive['name']);
                      while($mActive['has_sub'] && count($mActive['sub'])){
                      $ak = array_keys($mActive['sub']);
                      $mActive = $mActive['sub'][array_shift($ak)];
                      $mActiveName[] = $mActive['name'];
                      }
                      }
                      ?>

                      <?php if($mActive && $mActive['image']['ext']) { ?>
                      <img src="<?php echo Config::pathRel('images') . Catalog_Materials::$imagePath . $mActive['image']['id']; ?>_21x21_0.<?php echo $mActive['image']['ext']; ?>"
                           width="21" height="21" class="rounded-full border cursor-pointer"
                           title="<?php echo hsch(implode(' / ', $mActiveName))?>">
                      <?php } elseif($mActive) { ?>
                      <span class="text-xs text-gray-600 cursor-pointer">
                                                    <?php echo implode(' / ', $mActiveName)?>
                                                </span>
                      <?php } ?>



                      <div class="flex flex-col items-end">
                        <?php $d = abs($i['discount']); ?>
                        <?php if($d != 1 && $d !== 0) { ?>
                        <p id="item2-<?php echo $i['id']; ?>-price-old"
                           class="text-xs text-gray-400 line-through">
                          <?php echo Catalog::priceFormat($i['price_min'] / $d)?> ‚ÇΩ
                        </p>
                        <?php } ?>
                        <p id="item2-<?php echo $i['id']; ?>-price"
                           class="font-bold text-lg text-black whitespace-nowrap leading-5 <?php if(!abs($i['price_min'])) { ?>opacity-60<?php } ?>">
                          <?php if(abs($i['price_min'])) { ?>
                          <?php echo Catalog::priceFormat($i['price_min'])?> ‚ÇΩ
                          <?php } else { ?>
                          –ø–æ –∑–∞–ø—Ä–æ—Å—É
                          <?php } ?>
                        </p>
                      </div>


                      <div class="flex items-center gap-2">
                        <a href="javascript:void(0)" class="px-2 text-xl text-gray-600 no-underline"
                           onclick="oCart.amountMinus(this, true); seriesSetPrice(); return false;">-</a>
                        <input type="text" name="amount[<?php echo $i['id']; ?>]"
                               id="item2-<?php echo $i['id']; ?>-amount"
                               value="<?php echo $i['in_series_set_amount']; ?>"
                               class="w-12 text-center border rounded"
                               onchange="seriesSetPrice()" onkeyup="seriesSetPrice()"
                               onclick="seriesSetPrice()">
                        <span class="text-sm text-gray-500">—à—Ç</span>
                        <a href="javascript:void(0)" class="px-2 text-xl text-gray-600 no-underline"
                           onclick="oCart.amountPlus(this); seriesSetPrice(); return false;">+</a>

                        <input type="hidden" name="material_id[<?php echo $i['id']; ?>]"
                               id="item2-<?php echo $i['id']; ?>-material"
                               value="<?php echo ($mActive ? $mActive['id'] : 0)?>">
                        <input type="hidden" name="add[]" value="<?php echo $i['id']; ?>">
                      </div>
                    </div>
                  </div>
                  <div class="w-full h-[1px] bg-gray-200"></div>
                </div>
                <?php } ?>

                <button class="text-sm text-gray-400 underline" onclick="setShowAll(this)">
                  –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ
                </button>
              </div>
            </div>
            <script>
              function setShowAll(button) {
                const items = document.querySelectorAll('.arproducts > .series-item');
                const initiallyVisible = Array.from(items).slice(0, 3); // –ø–µ—Ä–≤—ã–µ 3 ‚Äî –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω—ã
                const toggleItems = Array.from(items).slice(3);         // –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º

                const isCurrentlyHidden = toggleItems.some(item => item.classList.contains('hidden'));

                if (isCurrentlyHidden) {
                  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º
                  toggleItems.forEach((item, index) => {
                    setTimeout(() => {
                      item.classList.remove('hidden');
                    }, index * 50); // –Ω–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ "–ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ–≥–æ" –ø–æ—è–≤–ª–µ–Ω–∏—è
                  });
                  button.textContent = '–°–∫—Ä—ã—Ç—å';
                } else {
                  // –°–∫—Ä—ã–≤–∞–µ–º
                  toggleItems.forEach(item => {
                    item.classList.add('hidden');
                  });
                  button.textContent = '–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ';
                }
              }
            </script>
            <script>RSGoPro_DetectTable();</script>
          </div>


          <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–Ω–∞ -->
          <div>
            <p id="series-set-price-old" class="text-xs text-gray-500 line-through">
              <!--will replace by JS-->
            </p>
            <div id="series-set-price" class="text-3xl font-bold text-black">
              <!--will replace by JS-->
            </div>
          </div>


          <!-- –ö–Ω–æ–ø–∫–∏ -->
          <div class="flex flex-col sm:flex-row gap-2">
            <!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É -->
            <form method="post" action="<?php echo Url::a('catalog-cart')?>"
                  onsubmit="updateCartButton(this); oCart.add(this, true); return false;"
                  style="display: inline;">
              <?php foreach($seriesSet as $i) { ?>
              <input type="hidden" name="add[]" value="<?php echo $i['id']; ?>">
              <input type="hidden" name="amount[<?php echo $i['id']; ?>]"
                     value="<?php echo $i['in_series_set_amount']; ?>">
              <input type="hidden" name="material_id[<?php echo $i['id']; ?>]"
                     value="<?php
                   $mActive = false;
                   if(count($i['materials'])) {
                       $mActive = $materials[$i['price_min_material_id']];
                   }
                   echo ($mActive ? $mActive['id'] : 0);
                   ?>">
              <?php } ?>

              <?php if(Catalog_Cart::isSetInCart($seriesSetItemsIds)) { ?>
              <button type="button"
                      class="bg-green-600 text-white py-2 px-12 rounded text-center font-semibold cursor-not-allowed opacity-90"
                      disabled>
                ‚úì –í –∫–æ—Ä–∑–∏–Ω–µ
              </button>
              <?php } else { ?>
              <button type="submit"
                      class="h-full w-full bg-blue-600 text-white py-2 px-6 rounded text-center font-semibold hover:bg-blue-700 transition-colors shadow-lg hover:shadow-xl"
                      title="–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Ç –≤ –∫–æ—Ä–∑–∏–Ω—É">
                –û—Ç–ª–æ–∂–∏—Ç—å –≤ 1 –∫–ª–∏–∫ —Å–æ –°–ö–ò–î–ö–û–ô
              </button>
              <?php } ?>
            </form>

            <script>
              function updateCartButton(form) {
                // –ù–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å"
                let btn = form.querySelector("button.submit");

                if (btn) {
                  btn.classList.remove("add2basket", "bg-blue-600", "hover:bg-blue-700");
                  btn.classList.add("inbasket", "bg-green-600", "cursor-not-allowed", "opacity-90");
                  btn.disabled = true;
                  btn.textContent = "‚úì –í –∫–æ—Ä–∑–∏–Ω–µ";
                }

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É "–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É"
                let go2basket = form.querySelector(".go2basket");
                if (go2basket) {
                  go2basket.style.display = "inline-block";
                }
              }
            </script>

            <!-- –ö–Ω–æ–ø–∫–∞ "–ù–∞—à–ª–∏ –¥–µ—à–µ–≤–ª–µ?" -->
            <button class="border-2 border-blue-600 text-blue-600 py-2 px-6 rounded text-center hover:bg-blue-50 transition-colors">
              <a rel="nofollow"
                 class="cheaper detail fancyajax fancybox.ajax"
                 href="<?php echo Url::a('contacts')?>?reason=<?php echo Contacts_Feedback::REASON_CHEAPER?>"
                 title="–ù–∞—à–ª–∏ –¥–µ—à–µ–≤–ª–µ?">
                –ù–∞—à–ª–∏ –¥–µ—à–µ–≤–ª–µ?
              </a>
            </button>
          </div>

          <script>
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
            function updateCartButtons() {
              const forms = document.querySelectorAll('.add2basketform');

              forms.forEach(form => {
                const button = form.querySelector('button[type="submit"]');
                const hiddenInputs = form.querySelectorAll('input[name="add[]"]');
                const itemIds = Array.from(hiddenInputs).map(input => input.value);

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–æ—Ä–∑–∏–Ω—ã (—ç—Ç–æ —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è)
                const isInCart = <?php echo Catalog_Cart::isSetInCart($seriesSetItemsIds) ? 'true' : 'false'; ?>;

                if (isInCart && button) {
                  button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                  button.classList.add('bg-green-600', 'hover:bg-green-700', 'cursor-not-allowed');
                  button.innerHTML = '‚úì –í –∫–æ—Ä–∑–∏–Ω–µ';
                  button.disabled = true;
                  button.type = 'button';
                }
              });
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            document.addEventListener('DOMContentLoaded', function() {
              updateCartButtons();

              // –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø–æ—Å–ª–µ AJAX –æ–ø–µ—Ä–∞—Ü–∏–π
              if (typeof oCart !== 'undefined') {
                const originalAdd = oCart.add;
                oCart.add = function() {
                  const result = originalAdd.apply(this, arguments);
                  // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
                  setTimeout(updateCartButtons, 100);
                  return result;
                };
              }
            });
          </script>

          <div class="flex flex-wrap gap-6">
            <!-- –£—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ -->
            <div class="text-sm space-y-1">
              <p>
                <img class="inline-block w-4 h-3" src="/images/product/truck.png" />
                <span class="underline">–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</span>
                <span class="underline font-bold">2‚Äì4 –¥–Ω—è</span>
              </p>
              <p>
                                    <span class="underline">–î–æ—Å—Ç–∞–≤–∫–∞ –∏ —Å–±–æ—Ä–∫–∞ (–ø–æ –ú–æ—Å–∫–≤–µ <br />
                                        –∏ –ú–û):</span>
                <span class="font-semibold">–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è</span>
              </p>
            </div>

            <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
            <div class="flex flex-col">
              <p>–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã:</p>
              <div class="flex gap-3 text-xl mt-1">
                <a href="https://wa.me/79859204824" target="_blank" title="WhatsApp">
                  <img src="/images/product/soc_wt.png" class="w-8 h-8" alt="Whatsapp" />
                </a>
                <a href="https://ok.ru/group/61739138941100" target="_blank" title="Tik Tok">
                  <img src="/images/product/soc_–æ–∫.png" class="w-8 h-8" alt="–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏" />
                </a>
                <a href="https://zen.yandex.ru/id/61bd9b90a5e7c35fbfbcad55" target="_blank" title="Zen">
                  <img src="/images/product/soc_zen.png" class="w-8 h-8" alt="Zen" />
                </a>
                <a href="https://vk.com/mebelioniru" target="_blank" title="Vk">
                  <img src="/images/product/soc_vk.png" class="w-8 h-8" alt="–í–ö–æ–Ω—Ç–∞–∫—Ç–µ" />
                </a>
                <a href="https://www.tiktok.com/@mebelioni.ru?lang=ru-RU" target="_blank" title="Tik Tok">
                  <img src="/images/product/soc_tiktok.png" class="w-8 h-8" alt="Tik Tok" />
                </a>
              </div>
            </div>
          </div>

          <!-- –¶–≤–µ—Ç–æ–≤–∞—è –≥–∞–º–º–∞ -->
          <?php if(count($materials)) { ?>
          <span class="mb-1 font-semibold">–¶–≤–µ—Ç–æ–≤–∞—è –≥–∞–º–º–∞:</span>

          <div class="series-materials new flex gap-2 flex-wrap">
            <?php
							function recurseSubMaterials($materials, $prevLevelName){
								foreach($materials as $m){
									if($m['has_sub']){
										print '<div class="series-materials-level2 ">';
            print '		<div class="cl"></div>';
            print '			<span class="b">' . $prevLevelName . ' / ' . $m['name'] . '</span>';

            recurseSubMaterials($m['sub'], $prevLevelName . ' / ' . $m['name']);

            print '			<div class="cl"></div>';
            print '</div>';
          }else{
          print '
          <div class="series-materials-level3">
            <div class="image">' .
              (
              $m['image']['ext'] ?
              '<img src="' . Config::pathRel('images') . Catalog_Materials::$imagePath . $m['image']['id'] . '_68x60_0.' . $m['image']['ext'] . '" width="68" height="60" alt="' . hsch($m['name']) . '">' :
              ''
              ) .
              '</div>
            <div class="name hidden">' . $m['name'] . '</div>
          </div>';
          }
          }
          }
          ?>
          <?php foreach($materials as $m) { ?>
          <?php if(!$m['current-series']) continue; ?>
          <?php if($m['has_sub']) { ?>
          <a class="level1" href="javascript:void(0)">
            <div class="w-[52px] h-[52px] bg-[#4E3B31] rounded-lg mb-2 flex items-center justify-center overflow-hidden">
              <?php if($m['image']['ext']) { ?>
              <img src="<?php echo Config::pathRel('images') . Catalog_Materials::$imagePath . $m['image']['id']; ?>_70x70_0.<?php echo $m['image']['ext']; ?>"
                   width="52" height="52"
                   alt="<?php echo hsch($m['name'])?>"
                   class="w-full h-full object-cover"
              >
              <?php } ?>
            </div>
            <div class="name hidden"><?php echo $m['name']; ?></div>
          </a>
          <div class="materials-zoom hidden">
            <div class="level1-sub">
              <?php recurseSubMaterials($m['sub'], $m['name']); ?>
              <div class="cl"></div>
            </div>
          </div>
          <?php } else { ?>
          <?php if($m['image']['ext']) { ?>
          <a class="level1 transform transition-transform duration-300 ease-in-out hover:scale-110" href="javascript:void(0)">
            <div class="flex gap-3 flex-wrap">
              <div class="w-14 h-14 border-[3px] border-[#2B48F1] rounded-lg">
                <div class="w-full h-full bg-[#8B4513] border-[3px] border-white rounded-lg flex items-center justify-center overflow-hidden">
                  <img src="<?php echo Config::pathRel('images') . Catalog_Materials::$imagePath . $m['image']['id']; ?>_70x70_0.<?php echo $m['image']['ext']; ?>"
                       width="70" height="70" alt="<?php echo hsch($m['name'])?>"
                       class="w-full h-full object-cover"
                  >
                </div>
              </div>
            </div>
            <div class="name hidden"><?php echo $m['name']; ?></div>
          </a>
          <div class="materials-zoom hidden">
            <img src="<?php echo Config::pathRel('images') . Catalog_Materials::$imagePath . $m['image']['id']; ?>.<?php echo $m['image']['ext']; ?>"  alt="<?php echo hsch($m['name'])?>">
          </div>
          <?php } else { ?>
          <div class="level1">
            <div class="image">&nbsp;</div>
            <div class="name text-sm hidden"><?php echo $m['name']; ?></div>
          </div>
          <?php } ?>
          <?php } ?>
          <?php } ?>
          <div class="cl"></div>
        </div>
        <?php } ?>
      </div>
    </div>
  </div>
</div>

<!-- –í–µ—Ä—Ö–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ -->
<div class="elementdetail" id="options-block">
  <!-- –ö–Ω–æ–ø–∫–∏-–≤–∫–ª–∞–¥–∫–∏ -->
  <div class="flex flex-wrap gap-3 mt-10 mb-6">
    <?php if (count($options)) { ?>
    <button id="section-specs"
            class="px-4 py-2 rounded-lg shadow text-sm bg-white hover:bg-gray-50"
            onclick="showTab('options')">
      –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    </button>
    <?php } ?>

    <button
      class="px-4 py-2 rounded-lg shadow text-sm bg-white hover:bg-gray-50"
      onclick="showTab('delivery')">
      –î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞
    </button>

    <button
      class="px-4 py-2 rounded-lg shadow text-sm bg-white hover:bg-gray-50"
      onclick="showTab('commercial')">
      –ö–æ–º. –ü—Ä–µ–¥
    </button>

    <button
      class="px-4 py-2 rounded-lg shadow text-sm bg-white hover:bg-gray-50"
      onclick="showTab('sets')">
      –ö–æ–º–ø–ª–µ–∫—Ç—ã
    </button>

    <button
      class="px-4 py-2 rounded-lg shadow text-sm bg-white hover:bg-gray-50"
      onclick="showTab('download')">
      –°–∫–∞—á–∞—Ç—å
    </button>

    <button
      class="px-4 py-2 rounded-lg shadow text-sm bg-white hover:bg-gray-50"
      onclick="showTab('questions')">
      –í–æ–ø—Ä–æ—Å—ã
    </button>

    <button
      class="px-4 py-2 rounded-lg shadow text-sm bg-white hover:bg-gray-50"
      onclick="showTab('reviews')">
      –û—Ç–∑—ã–≤—ã
    </button>
  </div>

  <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
  <div class="description1">

    <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
    <div class="text options" id="tab-options" style="display: none;" itemprop="description">
      <?php if (!is_null($seriesInf['delivery_time']) && trim($seriesInf['delivery_time']) !== '') { ?>
      <span class="opacity-60">–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</span>
      <?php echo htmlspecialchars($seriesInf['delivery_time']); ?>
      <br>
      <?php } ?>
      <?php foreach ($options as $o) { ?>
      <span><?php echo htmlspecialchars($o['name']); ?>:</span>
      <?php echo htmlspecialchars($o['value']); ?>
      <br>
      <?php } ?>
    </div>

    <!-- –î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞ -->
    <div class="text" id="tab-delivery" style="display: none;">
      <?php
            $t = $catInf['series_info'];
            $t = str_replace('[name]', htmlspecialchars($seriesInf['name']), $t);
            $t = str_replace('%d%', '<span class="text-delivery-price info-delivery"></span>', $t);
      $t = str_replace('%a%', '<span class="text-delivery-price info-assembly"></span>', $t);
      $t = str_replace('%F%', '<span class="text-delivery-price info-unloading"></span>', $t);
      echo $t;
      ?>
    </div>

    <!-- –ö–æ–º. –ü—Ä–µ–¥ (–ø—Ä–∏–º–µ—Ä –ø—É—Å—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞) -->
    <div class="text" id="tab-commercial" style="display: none;">
      –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.
    </div>

    <!-- –ö–æ–º–ø–ª–µ–∫—Ç—ã -->
    <div class="text" id="tab-sets" style="display: none;">
      –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ö.
    </div>

    <!-- –°–∫–∞—á–∞—Ç—å -->
    <div class="text" id="tab-download" style="display: none;">
      –§–∞–π–ª—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è: –ø–∞—Å–ø–æ—Ä—Ç, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, —á–µ—Ä—Ç–µ–∂–∏.
    </div>

    <!-- –í–æ–ø—Ä–æ—Å—ã -->
    <div class="text" id="tab-questions" style="display: none;">
      <a name="review"></a>
      <h3>–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å</h3>
      <p>–§–æ—Ä–º–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–æ–ø—Ä–æ—Å–∞ –ø–æ —Ç–æ–≤–∞—Ä—É.</p>
    </div>

    <!-- –û—Ç–∑—ã–≤—ã -->
    <div class="text" id="tab-reviews" style="display: none;">
      <h3>–û—Ç–∑—ã–≤—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</h3>
      <p>–û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
    </div>
  </div>
</div>

<script>
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
  function showTab(tabName) {
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ
    document.querySelectorAll('.description1 .text').forEach(div => {
      div.style.display = 'none';
    });

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é
    document.getElementById('tab-' + tabName).style.display = 'block';
  }

  // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫—Ä—ã–≤–∞–µ–º "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏" –∏–ª–∏ "–î–æ—Å—Ç–∞–≤–∫—É"
  document.addEventListener('DOMContentLoaded', function () {
    <?php if (count($options)) { ?>
      showTab('options');
      <?php } else { ?>
      showTab('delivery');
      <?php } ?>
  });
</script>

<hr class="mb-6 border-gray-300 mt-12" />

<?php
// –ë–∞–∑–æ–≤—ã–π URL
$baseUrl = 'http://pinitk85.beget.tech';

// –î–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ (–º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–ª–∏ –ë–î)
$benefits = [
    [
        'url' => '/preimuschestva/nizkie-tseny-i-skidki/',
'icon' => '/images/product/rub.png',
'title' => '–°–∞–º—ã–µ –Ω–∏–∑–∫–∏–µ —Ü–µ–Ω—ã!',
'text' => '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∫–∞–∂–¥–æ–º—É –∑–∞–∫–∞–∑—á–∏–∫—É. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫–∏–¥–∫–∏. –£–¥–æ–±–Ω–∞—è –æ–ø–ª–∞—Ç–∞, —Å –ù–î–° –∏ –±–µ–∑, –¥–æ–≥–æ–≤–æ—Ä.'
],
[
'url' => '/preimuschestva/garantiya-ot-proizvoditelya/',
'icon' => '/images/product/user.png',
'title' => '–ì–∞—Ä–∞–Ω—Ç–∏—è –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è!',
'text' => '–ú–µ–±–µ–ª—å —Ç–æ–ª—å–∫–æ –ª—É—á—à–∏—Ö —Ñ–∞–±—Ä–∏–∫, –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –†–æ—Å—Å–∏–∏ –∏ –∑–∞—Ä—É–±–µ–∂—å—è.'
],
[
'url' => '/preimuschestva/nashi-sotrudniki-professionaly-svoego-dela/',
'icon' => '/images/product/rule.png',
'title' => '–í—ã–∑–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –≤ –æ—Ñ–∏—Å –∏–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é —ç–∫—Å–ø–µ—Ä—Ç–∞!',
'text' => '–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–º –∫–∞—Ç–∞–ª–æ–≥–∏ –∏ –æ–±—Ä–∞–∑—Ü—ã, –¥–∏–∑–∞–π–Ω –ø—Ä–æ–µ–∫—Ç –∏ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É –í–∞—à–µ–π –æ—Ñ–∏—Å–Ω–æ–π –º–µ–±–µ–ª–∏.'
],
[
'url' => '/preimuschestva/prostota-vybora/',
'icon' => '/images/product/busket.png',
'title' => '–ö–∞–∫ —É—Ç–æ—á–Ω–∏—Ç—å –∏ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∫—É–ø–∫—É!',
'text' => '–ù–∞ –Ω–∞—à–µ–º —Å–∞–π—Ç–µ –Ω–µ –Ω–∞–¥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑ –≤ –∫–æ—Ä–∑–∏–Ω—É –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω. –ü–æ–¥–∞—Ä–∫–∏ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ —Å–∞–π—Ç.'
]
];
?>

<section>
  <!-- –ü–æ—á–µ–º—É —É –Ω–∞—Å -->
  <h2 class="text-2xl font-bold mt-28 mb-12">–ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –∑–∞–∫–∞–∑–∞—Ç—å —É –Ω–∞—Å</h2>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 justify-between text-sm md:text-base font-medium">
    <?php foreach ($benefits as $item): ?>
    <a href="<?php echo $baseUrl . $item['url']; ?>"
       class="flex items-start gap-2 bg-white p-3 shadow rounded no-underline text-current hover:no-underline"
       target="_blank"
    >
      <div class="shadow-[inset_0px_0px_10px_4px_rgba(43,72,241,0.20)] p-3 rounded-md shrink-0">
        <img src="<?php echo $item['icon']; ?>"
             class="w-3 h-4 lg:w-5 lg:h-6 md:w-4 md:h-5"
             alt="<?php echo htmlspecialchars($item['title']); ?>" />
      </div>
      <p class="text-lg font-medium">
        <?php echo htmlspecialchars($item['title']); ?>
        <span class="block font-normal"><?php echo htmlspecialchars($item['text']); ?></span>
      </p>
    </a>
    <?php endforeach; ?>
  </div>
</section>


<?php if (count($itemsGroups)) { ?>
<section id="section-prices" class="series-items mt-20">
  <div >
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <h2 class="text-2xl font-bold mb-6">
      –≠–ª–µ–º–µ–Ω—Ç—ã –º–µ–±–µ–ª–∏
      <span class="text-gray-500 font-normal">"<?php echo htmlspecialchars($seriesInf['name']); ?>"</span>
    </h2>

    <!<!-- –ú–µ–Ω—é –≥—Ä—É–ø–ø (–≤–∫–ª–∞–¥–∫–∏) -->
    <?php if (count($itemsGroups) > 1) { ?>
    <div class="sticky top-0 bg-body z-10 pt-4 pb-2 -mx-4 px-4 shadow-sm">
      <div class="flex flex-wrap gap-3">
        <!-- –ö–Ω–æ–ø–∫–∞ "–ù–∞–≤–µ—Ä—Ö" -->
        <a href="#top" class="min-w-[120px] px-4 py-1 rounded-lg shadow text-sm bg-white hover:bg-gray-50 text-center transition"
        >
          –ù–∞–≤–µ—Ä—Ö
        </a>

        <?php foreach ($itemsGroups as $g) {
                $groupId = (int)$g['id'];
                $groupName = htmlspecialchars(trim($g['name']) !== '' ? $g['name'] : '–†–∞–∑–Ω–æ–µ');
            ?>
        <a
          href="#group-<?php echo $groupId; ?>"
          onclick="return oItemsScroll.navTo(this.href)"
          id="menu-group-<?php echo $groupId; ?>"
          class="min-w-[120px] px-4 py-1 rounded-lg shadow text-sm bg-white hover:bg-gray-50 text-center transition group-tab-link"
          data-target="group-<?php echo $groupId; ?>"
        >
          <?php echo $groupName; ?>
        </a>
        <?php } ?>
      </div>
    </div>
    <?php } ?>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const links = document.querySelectorAll('.group-tab-link');
        const sections = [];

        // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Å—Å—ã–ª–∫–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –±–ª–æ–∫–∏
        links.forEach(link => {
          const targetId = link.getAttribute('data-target');
          const section = document.getElementById(targetId);
          if (section) {
            sections.push({ link, element: section });

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞
            link.addEventListener('click', function (e) {
              e.preventDefault(); // –û—Ç–º–µ–Ω—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

              // –ü–ª–∞–≤–Ω–æ —Å–∫—Ä–æ–ª–ª–∏–º –∫ —Å–µ–∫—Ü–∏–∏
              section.scrollIntoView({
                behavior: 'smooth',
                block: 'start',
                inline: 'nearest'
              });
            });
          }
        });

        // –§—É–Ω–∫—Ü–∏—è: —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Å—Ç–∏–ª–∏
        const resetStyles = () => {
          links.forEach(link => {
            link.className = 'min-w-[120px] px-4 py-1 rounded-lg shadow text-sm bg-white hover:bg-gray-50 text-center transition group-tab-link';
          });
        };

        // –§—É–Ω–∫—Ü–∏—è: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∏–ª—å –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
        const setActive = (link) => {
          link.className = 'min-w-[120px] px-4 py-1 rounded-lg shadow text-sm border-2 border-blue-600 text-blue-600 text-center transition';
        };

        // –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å –∑–∞ –≤–∏–¥–∏–º–æ—Å—Ç—å—é —Å–µ–∫—Ü–∏–π
        // –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å –∑–∞ –≤–∏–¥–∏–º–æ—Å—Ç—å—é —Å–µ–∫—Ü–∏–π
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              resetStyles();
              const activeLink = sections.find(s => s.element === entry.target)?.link;
              if (activeLink) {
                setActive(activeLink);
              }
            }
          });
        }, {
          rootMargin: '0px 0px -99% 0px', // —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –≤–µ—Ä—Ö —Å–µ–∫—Ü–∏–∏ —É –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –æ–∫–Ω–∞
          threshold: 0
        });

        // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–µ–π
        sections.forEach(s => observer.observe(s.element));
      });
    </script>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä—É–ø–ø -->
    <div class="groups-tabs">
      <?php $seriesOrig = $seriesInf; ?>
      <?php foreach ($itemsGroups as $g) {
                    $groupId = (int)$g['id'];
                    $groupName = trim($g['name']) !== '' ? $g['name'] : '–†–∞–∑–Ω–æ–µ';
                ?>

      <!-- –Ø–∫–æ—Ä—å –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ -->
      <a id="group-<?php echo $groupId; ?>" class="inline-block h-6 items-scroll-point"></a>

      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≥—Ä—É–ø–ø—ã -->
      <?php if ($g['h2']) { ?>
      <h3 class="text-xl font-semibold mb-6 text-gray-800 mt-8">
        <?php echo htmlspecialchars($groupName); ?>
        <span class="font-normal text-gray-500">"<?php echo htmlspecialchars($seriesOrig['name']); ?>"</span>
      </h3>
      <?php } else { ?>
      <h4 class="text-lg font-medium mb-5 text-gray-700 border-t pt-6 mt-6">
        <?php echo htmlspecialchars($groupName); ?>
      </h4>
      <?php } ?>

      <!-- –°–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ -->
      <div class="grid grid-cols-2 sm2:grid-cols-4 gap-2 lg:gap-6" id="group-grid-<?php echo $groupId; ?>">
        <?php foreach ($g['items'] as $item) { ?>
        <?php
                            $seriesInf = ($item['series_id'] == $seriesOrig['id'])
                                ? $seriesOrig
                                : ($crossSeries[$item['series_id']] ?? $seriesOrig);
                            ?>

        <div class="bg-white rounded-lg shadow p-4 lg:p-6 flex flex-col shadow hover:shadow-lg transition-shadow duration-300">
          <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
          <?php if (!empty($item['_img_ext'])): ?>

          <a
            href="javascript:void(0)"
            onclick="showItemPopup1('<?php echo Catalog_Items::a($seriesInf, $item)?>', <?php echo $item['id']; ?>); return false;"
          >
            <img
              src="<?php echo Catalog::photoUrl(
                                            Catalog_Items::$imagePath,
                                            $item['id'], 170, 140, 1, $item['_img_ext']
                                        ); ?>"
              alt="<?php echo hsch($item['name'] . ' ' . $item['art']); ?>"
              class="w-full h-28 lg:h-48 object-contain rounded-md mb-4"
            /></a>
          <?php else: ?>
          <div class="w-full h-28 lg:h-48 bg-gray-100 mb-4 flex items-center justify-center">
            <span class="text-gray-400 text-sm">–ù–µ—Ç —Ñ–æ—Ç–æ</span>
          </div>
          <?php endif; ?>

          <!-- –ê—Ä—Ç–∏–∫—É–ª -->
          <p class="text-gray-400 text-sm">–ê—Ä—Ç: <?php echo htmlspecialchars($item['art']); ?></p>

          <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
          <div class="relative mb-1" style="height: 2.5em;">
            <h3 class="font-medium text-sm sm2:text-base lg:text-lg leading-5
            line-clamp-2
            transition-all duration-200
            absolute top-0 left-0 right-0
            hover:line-clamp-none
            hover:z-10
            hover:bg-white
            hover:shadow-lg
            hover:rounded
            hover:px-2
            hover:py-1">
              <a href="<?php echo Catalog_Series::a($s); ?>" class="text-inherit hover:text-inherit block">
                <?php echo htmlspecialchars($item['name']); ?>
              </a>
            </h3>
          </div>

          <!-- –ì–∞–±–∞—Ä–∏—Ç—ã -->
          <?php if (!empty($item['size'])): ?>
          <p class="text-gray-400 text-sm mt-2">–®/–í/–î: <?php echo htmlspecialchars($item['size']); ?></p>
          <?php endif; ?>

          <!-- –¶–≤–µ—Ç–∞ -->
          <div class="flex gap-[6px] justify-start items-center mt-8 mb-3">
            <div class="favorishare">
              <?php if(count($item['materials'])) { ?>
              <script>
                oMaterials.items2mats[<?php echo $item['id']; ?>] = AJAX.jsonDecode('<?php echo str_replace('\'', '\\\'', toJson($item['materials']))?>');
              </script>
              <a
                href="javascript:void(0)"
                id="item1-<?php echo $item['id']; ?>-materials-preview"
                class="materials<?php /* pos-<?php echo ceil($mActiveN/7)*/?>"
                onclick="showItemPopup1('<?php echo Catalog_Items::a($seriesInf, $item)?>', <?php echo $item['id']; ?>); return false;"
              >
                <?php foreach($item['materials'] as $mn => $im) { ?>
                <?php $m = $materials[$im['material_id']]; ?>
                <div id="item1-<?php echo $item['id']; ?>-m-<?php echo $m['id']; ?>" <?php if($mActiveTopId == $m['id']) { ?>class="active"<?php } ?>>
                <?php if($m['image']['ext']) { ?>
                <img src="<?php echo Config::pathRel('images') . Catalog_Materials::$imagePath . $m['image']['id']; ?>_20x20_0.<?php echo $m['image']['ext']; ?>" width="20" height="20" alt="">
                <?php } ?>
            </div>
            <?php } ?>
            </a>
            <?php } ?>
          </div>

          </div>

          <!-- –¶–µ–Ω–∞ -->
          <div class="flex flex-wrap justify-between items-center mt-auto">
            <div>
              <?php $discount = abs($item['discount'] ?? 0); ?>
              <?php if ($discount > 0 && $discount != 1): ?>
              <div class="text-gray-600 text-sm line-through">
                <?php echo Catalog::priceFormat($item['price_min'] / $discount); ?> ‚ÇΩ
              </div>
              <?php endif; ?>
              <div class="font-bold text-lg">
                <?php if ($item['price_min'] > 0): ?>
                <?php echo Catalog::priceFormat($item['price_min']); ?> ‚ÇΩ
                <?php else: ?>
                –ø–æ –∑–∞–ø—Ä–æ—Å—É
                <?php endif; ?>
              </div>
            </div>


          </div>

          <!-- –ö–Ω–æ–ø–∫–∞ -->
          <a
            href="javascript:void(0)"
            onclick="showItemPopup1('<?php echo Catalog_Items::a($seriesInf, $item)?>', <?php echo $item['id']; ?>); return false;"
            class="mt-6 text-center border-[3px] border-blue-600 text-blue-600 rounded-md px-4 py-2 hover:bg-blue-50 transition font-medium"
          >
            <!--          <a-->
            <!--            href="<?php echo Catalog_Items::a($seriesInf, $item); ?>"-->
            <!--            class="mt-6 text-center border-[3px] border-blue-600 text-blue-600 rounded-md px-4 py-2 hover:bg-blue-50 transition font-medium"-->
            <!--          >-->
            –û—Ç–ª–æ–∂–∏—Ç—å
          </a>
        </div>
        <?php } ?>
      </div>
      <?php } ?>
      <?php $seriesInf = $seriesOrig; ?>
    </div>

    <!-- –Ø–∫–æ—Ä—å –≤–Ω–∏–∑—É -->
    <a id="items-end"></a>
  </div>
</section>
<?php } ?>

<?php if(count($linkages)) { ?>
<?php foreach($linkages as $ln => $l) { ?>
<div class="sorter_and_name clearfix">
  <div class="name" style="color: <?php echo $l['color_name']; ?>!important"><?php echo $l['name']; ?></div>
</div>
<div  class="ajaxpages_main">
  <div class="relative grid grid-cols-1 sm:grid-cols-2 sm2:grid-cols-3 lg:grid-cols-4 gap-6">
    <?php foreach($l['series'] as $s) { ?>
    <?php include(Config::path('skins') . '/html/Components/series_card.htm'); ?>
    <?php } ?>
  </div>
</div>
<?php } ?>
<?php } ?>



<noindex>
  <section class="mt-24">
    <div class="series_options bg-white px-4 md:px-8 lg:px-16 py-10 rounded-lg shadow-md flex flex-col lg:flex-row gap-8 md:gap-16">
      <div class="flex-1">
        <div class="series_options_item">
          <div class="series_info_title text-xl font-bold mb-4">
            <?php echo Options::name('series-info1-title'); ?>
          </div>
          <div class="series_info_text text-base">
            <?php echo Options::name('series-info1-text'); ?>
          </div>
        </div>
      </div>
      <div class="flex-1">
        <div class="series_options_item text-base">
          <div class="series_info_title text-xl font-bold mb-4">
            <?php echo Options::name('series-info2-title'); ?>
          </div>
          <div class="series_info_text">
            <?php echo Options::name('series-info2-text'); ?>
          </div>
        </div>
      </div>
      <div class="flex-1">
        <div class="series_options_item text-base">
          <div class="series_info_title text-xl font-bold mb-4">
            <?php echo Options::name('series-info3-title'); ?>
          </div>
          <div class="series_info_text">
            <?php echo Options::name('series-info3-text'); ?>
          </div>
        </div>
      </div>
    </div>
  </section>
</noindex>

</div>

</div>

<?php echo JsCopmress::load('slider-vertical'); ?>
<?php echo JsCopmress::load('series-set-price.js'); ?>
